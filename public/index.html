<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>H·ªá Th·ªëng Qu·∫£n L√Ω N√¥ng S·∫£n Ph√¢n T√°n</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- HEADER -->
    <header class="main-header">
      <div class="header-container">
        <div class="logo">
          <span class="logo-icon"></span>
          <div class="logo-text">
            <h1>H·ªá Th·ªëng N√¥ng S·∫£n</h1>
          </div>
        </div>
        <div class="header-actions">
          <div class="region-selector">
            <label>V√πng mi·ªÅn:</label>
            <select id="region-filter">
              <option value="">T·∫•t c·∫£</option>
              <option value="MienBac">Mi·ªÅn B·∫Øc</option>
              <option value="MienTrung">Mi·ªÅn Trung</option>
              <option value="MienNam">Mi·ªÅn Nam</option>
            </select>
          </div>
          <button class="btn-health" onclick="checkSystemHealth()">
            <span id="health-dot" class="health-dot"></span>
            Tr·∫°ng th√°i h·ªá th·ªëng
          </button>
        </div>
      </div>
    </header>

    <!-- NAVIGATION TABS -->
    <nav class="tab-navigation">
      <button
        class="tab-btn active"
        data-tab="products"
        onclick="switchTab('products')"
      >
        <span class="tab-icon"></span>
        <span>S·∫£n ph·∫©m</span>
      </button>
      <button class="tab-btn" data-tab="orders" onclick="switchTab('orders')">
        <span class="tab-icon"></span>
        <span>ƒê∆°n h√†ng</span>
      </button>
      <button
        class="tab-btn"
        data-tab="customers"
        onclick="switchTab('customers')"
      >
        <span class="tab-icon"></span>
        <span>Kh√°ch h√†ng</span>
      </button>
      <button
        class="tab-btn"
        data-tab="distribution"
        onclick="switchTab('distribution')"
      >
        <span class="tab-icon"></span>
        <span>Ki·∫øn tr√∫c ph√¢n t√°n</span>
      </button>
      <button
        class="tab-btn"
        data-tab="statistics"
        onclick="switchTab('statistics')"
      >
        <span class="tab-icon"></span>
        <span>Th·ªëng k√™</span>
      </button>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="main-container">
      <!-- TAB: S·∫¢N PH·∫®M -->
      <section id="tab-products" class="tab-content active">
        <div class="section-header">
          <h2>Danh s√°ch S·∫£n ph·∫©m</h2>
          <div class="header-actions">
            <div class="search-box">
              <input
                type="text"
                id="search-products"
                placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m..."
              />
            </div>
            <button class="btn-primary" onclick="openAddProductModal()">
              + Th√™m s·∫£n ph·∫©m
            </button>
          </div>
        </div>
        <div id="products-table" class="data-table-wrapper"></div>
      </section>

      <!-- TAB: ƒê∆†N H√ÄNG -->
      <section id="tab-orders" class="tab-content">
        <div class="section-header">
          <h2>Danh s√°ch ƒê∆°n h√†ng</h2>
          <div class="header-actions">
            <span class="record-count" id="orders-count">0 ƒë∆°n h√†ng</span>
            <button class="btn-primary" onclick="openAddOrderModal()">
              + Th√™m ƒë∆°n h√†ng
            </button>
          </div>
        </div>
        <div id="orders-table" class="data-table-wrapper"></div>
      </section>

      <!-- TAB: KH√ÅCH H√ÄNG -->
      <section id="tab-customers" class="tab-content">
        <div class="section-header">
          <h2>üë• Danh s√°ch Kh√°ch h√†ng</h2>
          <div class="header-actions">
            <span class="record-count" id="customers-count">0 kh√°ch h√†ng</span>
            <button class="btn-primary" onclick="openAddCustomerModal()">
              + Th√™m kh√°ch h√†ng
            </button>
          </div>
        </div>
        <div id="customers-table" class="data-table-wrapper"></div>
      </section>

      <!-- TAB: KI·∫æN TR√öC PH√ÇN T√ÅN -->
      <section id="tab-distribution" class="tab-content">
        <div class="section-header">
          <h2>Ki·∫øn tr√∫c H·ªá th·ªëng Ph√¢n t√°n</h2>
        </div>
        <div class="distribution-architecture">
          <div class="server-card master">
            <div class="server-icon">üñ•Ô∏è</div>
            <h3>SERVER (Master/Publisher)</h3>
            <p class="server-name">DESKTOP-1RUUANR\SERVER</p>
            <div class="server-details">
              <div class="detail-item">
                <span>Database:</span>
                <strong>NongSan_Master</strong>
              </div>
              <div class="detail-item">
                <span>Vai tr√≤:</span>
                <strong>Distributor + Publisher</strong>
              </div>
              <div class="detail-item">
                <span>Publications:</span>
                <strong>3 (Pub_MienBac, Pub_MienTrung, Pub_MienNam)</strong>
              </div>
            </div>
          </div>

          <div class="replication-flow">
            <div class="flow-arrow">
              <span>Replication</span>
              <div class="arrow-line"></div>
            </div>
          </div>

          <div class="client-servers">
            <div class="server-card client region-mienbac">
              <div class="server-icon">üíª</div>
              <h3>CLIENT 1 - Mi·ªÅn B·∫Øc</h3>
              <p class="server-name">DESKTOP-1RUUANR\CLIENT1</p>
              <div class="server-details">
                <div class="detail-item">
                  <span>Database:</span>
                  <strong>NongSan_MienBac</strong>
                </div>
                <div class="detail-item">
                  <span>Subscription:</span>
                  <strong>Pub_MienBac</strong>
                </div>
                <div class="detail-item">
                  <span>D·ªØ li·ªáu:</span>
                  <strong>VungMien = 'MienBac'</strong>
                </div>
              </div>
            </div>

            <div class="server-card client region-mientrung">
              <div class="server-icon">üíª</div>
              <h3>CLIENT 2 - Mi·ªÅn Trung</h3>
              <p class="server-name">DESKTOP-1RUUANR\CLIENT2</p>
              <div class="server-details">
                <div class="detail-item">
                  <span>Database:</span>
                  <strong>NongSan_MienTrung</strong>
                </div>
                <div class="detail-item">
                  <span>Subscription:</span>
                  <strong>Pub_MienTrung</strong>
                </div>
                <div class="detail-item">
                  <span>D·ªØ li·ªáu:</span>
                  <strong>VungMien = 'MienTrung'</strong>
                </div>
              </div>
            </div>

            <div class="server-card client region-miennam">
              <div class="server-icon">üíª</div>
              <h3>CLIENT 3 - Mi·ªÅn Nam</h3>
              <p class="server-name">DESKTOP-1RUUANR\CLIENT3</p>
              <div class="server-details">
                <div class="detail-item">
                  <span>Database:</span>
                  <strong>NongSan_MienNam</strong>
                </div>
                <div class="detail-item">
                  <span>Subscription:</span>
                  <strong>Pub_MienNam</strong>
                </div>
                <div class="detail-item">
                  <span>D·ªØ li·ªáu:</span>
                  <strong>VungMien = 'MienNam'</strong>
                </div>
              </div>
            </div>
          </div>

          <div class="additional-services">
            <div class="service-card mongodb">
              <div class="service-icon">üçÉ</div>
              <h3>MongoDB</h3>
              <div class="server-details">
                <div class="detail-item">
                  <span>Host:</span>
                  <strong>localhost:27017</strong>
                </div>
                <div class="detail-item">
                  <span>Database:</span>
                  <strong>nongsan_db</strong>
                </div>
                <div class="detail-item">
                  <span>Collection:</span>
                  <strong>hanghoa_details</strong>
                </div>
                <div class="detail-item">
                  <span>Vai tr√≤:</span>
                  <strong
                    >L∆∞u d·ªØ li·ªáu phi c·∫•u tr√∫c (M√¥ t·∫£, ƒë√°nh gi√°, URL ·∫£nh)</strong
                  >
                </div>
              </div>
            </div>

            <div class="service-card cloudinary">
              <div class="service-icon">‚òÅÔ∏è</div>
              <h3>Cloudinary</h3>
              <div class="server-details">
                <div class="detail-item">
                  <span>Cloud:</span>
                  <strong>dznbskxv6</strong>
                </div>
                <div class="detail-item">
                  <span>Folder:</span>
                  <strong>nongsan-images/</strong>
                </div>
                <div class="detail-item">
                  <span>Vai tr√≤:</span>
                  <strong>L∆∞u tr·ªØ ·∫£nh s·∫£n ph·∫©m (Multimedia)</strong>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- TAB: TH·ªêNG K√ä -->
      <section id="tab-statistics" class="tab-content">
        <div class="section-header">
          <h2>Th·ªëng k√™ H·ªá th·ªëng</h2>
        </div>
        <div id="statistics-content" class="statistics-grid"></div>
      </section>
    </main>

    <!-- MODAL CHI TI·∫æT S·∫¢N PH·∫®M -->
    <div id="modal-product-detail" class="modal">
      <div class="modal-content modal-large">
        <button
          class="modal-close"
          onclick="closeModal('modal-product-detail')"
        >
          √ó
        </button>
        <div id="product-detail-content"></div>
      </div>
    </div>

    <!-- MODAL TH√äM/S·ª¨A S·∫¢N PH·∫®M -->
    <div id="modal-product-form" class="modal">
      <div class="modal-content">
        <button class="modal-close" onclick="closeModal('modal-product-form')">
          √ó
        </button>
        <h2 id="form-title">Th√™m s·∫£n ph·∫©m m·ªõi</h2>
        <form id="product-form" onsubmit="handleProductSubmit(event)">
          <input type="hidden" id="form-product-id" />

          <div class="form-group">
            <label>T√™n s·∫£n ph·∫©m <span class="required">*</span></label>
            <input type="text" id="form-name" required />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Danh m·ª•c <span class="required">*</span></label>
              <select id="form-category" required></select>
            </div>
            <div class="form-group">
              <label>Nh√† cung c·∫•p</label>
              <select id="form-supplier"></select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>V√πng mi·ªÅn <span class="required">*</span></label>
              <select id="form-region" required>
                <option value="MienBac">Mi·ªÅn B·∫Øc</option>
                <option value="MienTrung">Mi·ªÅn Trung</option>
                <option value="MienNam">Mi·ªÅn Nam</option>
              </select>
            </div>
            <div class="form-group">
              <label>ƒê∆°n v·ªã t√≠nh</label>
              <input type="text" id="form-unit" placeholder="Kg, n·∫£i, qu·∫£..." />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Gi√° nh·∫≠p (VNƒê)</label>
              <input type="number" id="form-cost" step="1000" />
            </div>
            <div class="form-group">
              <label>Gi√° b√°n (VNƒê) <span class="required">*</span></label>
              <input type="number" id="form-price" required step="1000" />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>S·ªë l∆∞·ª£ng t·ªìn</label>
              <input type="number" id="form-stock" value="0" />
            </div>
            <div class="form-group">
              <label>H·∫°n s·ª≠ d·ª•ng</label>
              <input type="date" id="form-expiry" />
            </div>
          </div>

          <div class="form-group">
            <label>Upload ·∫£nh s·∫£n ph·∫©m</label>
            <input
              type="file"
              id="form-image"
              accept="image/*"
              onchange="previewProductImage(this)"
            />
            <img
              id="preview-image"
              style="
                display: none;
                max-width: 200px;
                margin-top: 10px;
                border-radius: 8px;
              "
            />
          </div>

          <div class="form-group">
            <label>M√¥ t·∫£ chi ti·∫øt (l∆∞u v√†o MongoDB)</label>
            <textarea
              id="form-description"
              rows="4"
              placeholder="Nh·∫≠p m√¥ t·∫£ chi ti·∫øt v·ªÅ s·∫£n ph·∫©m..."
            ></textarea>
          </div>

          <div class="form-actions">
            <button
              type="button"
              class="btn-secondary"
              onclick="closeModal('modal-product-form')"
            >
              H·ªßy
            </button>
            <button type="submit" class="btn-primary">L∆∞u</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL TH√äM ƒê∆†N H√ÄNG -->
    <div id="modal-order-form" class="modal">
      <div class="modal-content">
        <button class="modal-close" onclick="closeModal('modal-order-form')">
          √ó
        </button>
        <h2>üõí T·∫°o ƒë∆°n h√†ng m·ªõi</h2>
        <form id="order-form" onsubmit="handleOrderSubmit(event)">
          <div class="form-row">
            <div class="form-group">
              <label>Kh√°ch h√†ng <span class="required">*</span></label>
              <select id="form-order-customer" required></select>
            </div>
            <div class="form-group">
              <label>V√πng mi·ªÅn <span class="required">*</span></label>
              <select id="form-order-region" required>
                <option value="MienBac">Mi·ªÅn B·∫Øc</option>
                <option value="MienTrung">Mi·ªÅn Trung</option>
                <option value="MienNam">Mi·ªÅn Nam</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>S·∫£n ph·∫©m ƒë·∫∑t h√†ng</label>
            <button
              type="button"
              class="btn-primary btn-sm"
              onclick="addOrderItem()"
            >
              + Th√™m s·∫£n ph·∫©m
            </button>
            <div id="order-items-list" style="margin-top: 10px"></div>
          </div>

          <div class="form-actions">
            <button
              type="button"
              class="btn-secondary"
              onclick="closeModal('modal-order-form')"
            >
              H·ªßy
            </button>
            <button type="submit" class="btn-primary">T·∫°o ƒë∆°n</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL TH√äM/S·ª¨A KH√ÅCH H√ÄNG -->
    <div id="modal-customer-form" class="modal">
      <div class="modal-content">
        <button class="modal-close" onclick="closeModal('modal-customer-form')">
          √ó
        </button>
        <h2 id="customer-form-title">Th√™m kh√°ch h√†ng m·ªõi</h2>
        <form id="customer-form" onsubmit="handleCustomerSubmit(event)">
          <input type="hidden" id="form-customer-id" />

          <div class="form-group">
            <label>T√™n kh√°ch h√†ng <span class="required">*</span></label>
            <input type="text" id="form-customer-name" required />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Email</label>
              <input type="email" id="form-customer-email" />
            </div>
            <div class="form-group">
              <label>S·ªë ƒëi·ªán tho·∫°i</label>
              <input type="tel" id="form-customer-phone" />
            </div>
          </div>

          <div class="form-group">
            <label>ƒê·ªãa ch·ªâ</label>
            <input type="text" id="form-customer-address" />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>V√πng mi·ªÅn <span class="required">*</span></label>
              <select id="form-customer-region" required>
                <option value="MienBac">Mi·ªÅn B·∫Øc</option>
                <option value="MienTrung">Mi·ªÅn Trung</option>
                <option value="MienNam">Mi·ªÅn Nam</option>
              </select>
            </div>
            <div class="form-group">
              <label>Lo·∫°i kh√°ch h√†ng</label>
              <select id="form-customer-type">
                <option value="Th∆∞·ªùng">Th∆∞·ªùng</option>
                <option value="VIP">VIP</option>
                <option value="Doanh nghi·ªáp">Doanh nghi·ªáp</option>
              </select>
            </div>
          </div>

          <div class="form-actions">
            <button
              type="button"
              class="btn-secondary"
              onclick="closeModal('modal-customer-form')"
            >
              H·ªßy
            </button>
            <button type="submit" class="btn-primary">L∆∞u</button>
          </div>
        </form>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
